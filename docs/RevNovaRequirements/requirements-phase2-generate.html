<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Phase 2 - Generate with AI | RevNova Requirements</title>
    <link rel="stylesheet" href="../styles.css">
                <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; }
        
        .requirements-layout {
            display: flex;
            min-height: calc(100vh - 80px);
            margin-top: 80px;
        }
        
        /* Salesforce-style sidebar */
        .sidebar {
            width: 280px;
            background: #f4f6f9;
            border-right: 1px solid #c9c9c9;
            position: fixed;
            height: calc(100vh - 80px);
            overflow-y: auto;
            top: 80px;
            left: 0;
            z-index: 100;
        }
        
        .sidebar::-webkit-scrollbar { width: 8px; }
        .sidebar::-webkit-scrollbar-track { background: #f4f6f9; }
        .sidebar::-webkit-scrollbar-thumb { background: #c9c9c9; border-radius: 4px; }
        .sidebar::-webkit-scrollbar-thumb:hover { background: #a8a8a8; }
        
        .sidebar-nav { padding: 1rem 0; }
        
        .nav-section { margin-bottom: 0.25rem; }
        
        .nav-section-header {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            font-size: 13px;
            font-weight: 600;
            color: #181818;
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
            transition: background 0.15s;
        }
        
        .nav-section-header:hover { background: #e5e5e5; }
        .nav-section-header.expanded { background: #e5e5e5; }
        
        .nav-section-icon {
            width: 16px;
            height: 16px;
            margin-right: 0.5rem;
            transition: transform 0.2s;
            flex-shrink: 0;
        }
        
        .nav-section-header.expanded .nav-section-icon { transform: rotate(90deg); }
        
        .nav-section-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .nav-section-content.expanded { max-height: 2000px; }
        
        .nav-link {
            display: block;
            padding: 0.5rem 1rem 0.5rem 2.5rem;
            color: #006dcc;
            text-decoration: none;
            font-size: 13px;
            transition: background 0.15s;
        }
        
        .nav-link:hover {
            background: #e5e5e5;
            text-decoration: underline;
        }
        
        .nav-link.active {
            background: #1589ee;
            color: #fff;
            font-weight: 600;
        }
        
        .nav-link.active:hover {
            background: #0b5cab;
            text-decoration: none;
        }
        
        .nav-subsection { margin: 0.25rem 0; }
        
        .nav-subsection-header {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem 0.5rem 2.5rem;
            font-size: 13px;
            font-weight: 500;
            color: #181818;
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
            transition: background 0.15s;
        }
        
        .nav-subsection-header:hover { background: #e5e5e5; }
        .nav-subsection-header.expanded { background: #e5e5e5; }
        
        .nav-subsection-icon {
            width: 12px;
            height: 12px;
            margin-right: 0.5rem;
            transition: transform 0.2s;
            flex-shrink: 0;
        }
        
        .nav-subsection-header.expanded .nav-subsection-icon { transform: rotate(90deg); }
        
        .nav-subsection-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .nav-subsection-content.expanded { max-height: 1000px; }
        
        .nav-subsection-link {
            display: block;
            padding: 0.4rem 1rem 0.4rem 3.5rem;
            color: #006dcc;
            text-decoration: none;
            font-size: 13px;
            transition: background 0.15s;
        }
        
        .nav-subsection-link:hover {
            background: #e5e5e5;
            text-decoration: underline;
        }
        
        .nav-subsection-link.active {
            background: #1589ee;
            color: #fff;
            font-weight: 600;
        }
        
        .nav-subsection-link.active:hover {
            background: #0b5cab;
            text-decoration: none;
        }
        
        /* Main content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 2rem 3rem;
            background: #fff;
            min-width: 0;
        }

        
        
        .page-header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:3rem;border-radius:12px;margin-bottom:3rem}
        .section-box{background:#fff;border:2px solid #e0e0e0;padding:2.5rem;margin:2rem 0;border-radius:12px}
        .section-box h3{color:#667eea;margin-top:0;border-bottom:2px solid #764ba2;padding-bottom:0.5rem}
        table{width:100%;border-collapse:collapse;margin:1.5rem 0}
        th,td{border:1px solid #ddd;padding:12px;text-align:left}
        th{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;font-weight:600;font-size:0.85rem}
        .badge-functional{background:#3498db;color:#fff;padding:0.3rem 0.6rem;border-radius:12px;font-size:0.75rem;font-weight:600}
        .badge-technical{background:#e74c3c;color:#fff;padding:0.3rem 0.6rem;border-radius:12px;font-size:0.75rem;font-weight:600}
        .ui-wireframe{background:#f9f9f9;border:2px dashed #ccc;padding:1.5rem;margin:1rem 0;border-radius:8px;font-family:monospace;font-size:0.85rem;line-height:1.6}
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <div class="nav-left">
                <a href="../index.html" class="logo"><div class="logo-box">RevNova</div></a>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../about-revnova.html">About RevNova</a></li>
                        <li><a href="../features.html">Features</a></li>
                        <li><a href="../pricing.html">Pricing</a></li>
                        <li><a href="requirements-home.html" class="active">RevNova Requirements</a></li>
                        <li><a href="../contact.html">Contact</a></li>
                    </ul>
                </nav>
            </div>
            <div class="header-right">
                <div class="country-selector"><span class="fi fi-us"></span></div>
                <a href="../login.html" class="btn btn-login">Login</a>
            </div>
        </div>
    </header>

    <div class="requirements-layout">
                                        <aside class="sidebar">
            <nav class="sidebar-nav">
                <!-- Platform Vision Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Platform Vision
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-home.html" class="nav-link">RevNova Vision & Strategy</a>
                        <a href="business-requirements.html" class="nav-link">High Level Business Requirements</a>
                        <a href="high-level-functional.html" class="nav-link">High Level Functional Design</a>
                    </div>
                </div>
                
                <!-- Phase 1 Section -->
                <div class="nav-section">
                    <button class="nav-section-header expanded">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 1 - SFDC CPQ â†’ RCA Migration (MVP)
                    </button>
                    <div class="nav-section-content expanded">
                        <!-- Functional Requirements Subsection -->
                        <div class="nav-subsection">
                            <button class="nav-subsection-header">
                                <svg class="nav-subsection-icon" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M6 6L14 10L6 14V6Z"/>
                                </svg>
                                Functional Requirements
                            </button>
                            <div class="nav-subsection-content">
                                <a href="requirements-phase1-connect.html" class="nav-subsection-link">1. Connection Wizard</a>
                                <a href="requirements-phase1-analyze.html" class="nav-subsection-link">2. Schema Analysis</a>
                                <a href="requirements-phase1-mapping.html" class="nav-subsection-link">3. Field Mapping</a>
                                <a href="requirements-phase1-transform.html" class="nav-subsection-link">4. Data Transformation</a>
                                <a href="requirements-phase1-validate.html" class="nav-subsection-link">5. Validation</a>
                                <a href="requirements-phase1-execute.html" class="nav-subsection-link">6. Migration Execution</a>
                                <a href="requirements-phase1-test.html" class="nav-subsection-link">7. Post-Migration Testing</a>
                                <a href="requirements-phase1-quotes.html" class="nav-subsection-link">8. Quotes</a>
                                <a href="requirements-phase1-contracts.html" class="nav-subsection-link">9. Contracts</a>
                                <a href="requirements-phase1-subscriptions.html" class="nav-subsection-link">10. Subscriptions</a>
                                <a href="requirements-phase1-inflight.html" class="nav-subsection-link">11. In-Flight Orders</a>
                            </div>
                        </div>
                        
                        <!-- Technical Requirements Subsection -->
                        <div class="nav-subsection">
                            <button class="nav-subsection-header">
                                <svg class="nav-subsection-icon" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M6 6L14 10L6 14V6Z"/>
                                </svg>
                                Technical Requirements
                            </button>
                            <div class="nav-subsection-content">
                                <a href="requirements-phase1-technical.html" class="nav-subsection-link">Migration Architecture</a>
                                <a href="requirements-phase1-technical.html#api" class="nav-subsection-link">API Specifications</a>
                                <a href="requirements-phase1-technical.html#database" class="nav-subsection-link">Database Schema</a>
                                <a href="requirements-phase1-technical.html#orchestration" class="nav-subsection-link">Orchestration Engine</a>
                            </div>
                        </div>
                        
                        <a href="requirements-mapping.html" class="nav-link">Complete Field Mapping</a>
                    </div>
                </div>
                
                <!-- Phase 2 Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 2 - AI-Powered Configuration
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-phase2-functional.html" class="nav-link">Functional Requirements</a>
                        <a href="requirements-phase2-technical.html" class="nav-link">Technical Requirements</a>
                        <a href="ai-product-configuration.html" class="nav-link">AI Product Configuration Engine</a>
                    </div>
                </div>
                
                <!-- Phase 3 Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 3 - Multi-CPQ Support
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-phase3-functional.html" class="nav-link">Functional Requirements</a>
                        <a href="requirements-phase3-technical.html" class="nav-link">Technical Requirements</a>
                    </div>
                </div>
                
                <!-- Phase 4 Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 4 - CRM Integration
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-phase4-functional.html" class="nav-link">Functional Requirements</a>
                        <a href="requirements-phase4-technical.html" class="nav-link">Technical Requirements</a>
                    </div>
                </div>
                
                <!-- Phase 5 Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 5 - ERP Connector
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-phase5-functional.html" class="nav-link">Functional Requirements</a>
                        <a href="requirements-phase5-technical.html" class="nav-link">Technical Requirements</a>
                    </div>
                </div>
                
                <!-- Additional Resources -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Additional Resources
                    </button>
                    <div class="nav-section-content">
                        <a href="security-compliance.html" class="nav-link">Security & Compliance</a>
                        <a href="performance-scalability.html" class="nav-link">Performance & Scalability</a>
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h1>ğŸ¤– Generate with AI - Natural Language Product Design</h1>
                <p>Transform business requirements into fully-specified product configurations using AI</p>
            </div>

            <div class="ui-wireframe">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Generate New Product with AI                         [Help] [?]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ“ Describe your product in plain English:                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ "I need a subscription-based SaaS product with 3 tiers:   â”‚ â”‚
â”‚  â”‚  Starter ($49/mo, 5 users, 10GB storage),                 â”‚ â”‚
â”‚  â”‚  Professional ($99/mo, 20 users, 100GB storage),          â”‚ â”‚
â”‚  â”‚  Enterprise ($249/mo, unlimited users, 1TB storage).      â”‚ â”‚
â”‚  â”‚  Include annual billing discount of 20%."                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  [Optional] Upload reference documents: [ğŸ“ Attach Files]      â”‚
â”‚  â˜ Product Brief PDF  â˜ Competitor Analysis  â˜ Pricing Sheet  â”‚
â”‚                                                                 â”‚
â”‚                    [ğŸ”® Generate Product Spec]                  â”‚
â”‚                                                                 â”‚
â”‚  â³ AI is analyzing your requirements... (15 seconds)          â”‚
â”‚                                                                 â”‚
â”‚  âœ… Generated Product Configuration:                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Product Name: SaaS Subscription Suite                     â”‚ â”‚
â”‚  â”‚ Product Family: Cloud Software                            â”‚ â”‚
â”‚  â”‚ Pricing Model: Subscription-based (Monthly/Annual)        â”‚ â”‚
â”‚  â”‚ Billing Frequency: Monthly, Annual (20% discount)         â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚ â–¼ 3 SKUs Detected:                                        â”‚ â”‚
â”‚  â”‚   â€¢ Starter Edition ($49/mo, $470/yr)                     â”‚ â”‚
â”‚  â”‚   â€¢ Professional Edition ($99/mo, $950/yr)                â”‚ â”‚
â”‚  â”‚   â€¢ Enterprise Edition ($249/mo, $2,390/yr)               â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚ â–¼ 4 Features Detected:                                    â”‚ â”‚
â”‚  â”‚   â€¢ User Limit (Starter: 5, Pro: 20, Ent: Unlimited)      â”‚ â”‚
â”‚  â”‚   â€¢ Storage Limit (Starter: 10GB, Pro: 100GB, Ent: 1TB)   â”‚ â”‚
â”‚  â”‚   â€¢ Priority Support (Pro+)                               â”‚ â”‚
â”‚  â”‚   â€¢ Custom Branding (Enterprise only)                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚         [âœï¸ Review & Edit]    [ğŸ’¾ Save Draft]    [âŒ Start Over]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>

            <section class="section-box">
                <h3><span class="badge-functional">Functional</span> AI-Powered Product Generation</h3>
                <table>
                    <tr><th>Requirement ID</th><th>Description</th><th>Acceptance Criteria</th></tr>
                    <tr>
                        <td><strong>FR-GEN-001.1</strong></td>
                        <td>Natural Language Input Form</td>
                        <td>â€¢ Multi-line text area (min 50 chars, max 5000 chars)<br>â€¢ Real-time character counter<br>â€¢ Placeholder with sample prompts<br>â€¢ Save draft functionality (auto-save every 30 seconds)</td>
                    </tr>
                    <tr>
                        <td><strong>FR-GEN-001.2</strong></td>
                        <td>File Attachment Support</td>
                        <td>â€¢ Accept PDF, DOCX, XLSX, CSV (max 10MB per file, up to 5 files)<br>â€¢ Extract text from documents using OCR if needed<br>â€¢ Display upload progress bar<br>â€¢ Virus scan before processing</td>
                    </tr>
                    <tr>
                        <td><strong>FR-GEN-001.3</strong></td>
                        <td>AI Processing Indicator</td>
                        <td>â€¢ Show spinner + estimated time (10-30 seconds)<br>â€¢ Display "AI is thinking..." message<br>â€¢ Prevent multiple simultaneous submissions<br>â€¢ Handle timeout gracefully (show retry option after 60 seconds)</td>
                    </tr>
                    <tr>
                        <td><strong>FR-GEN-001.4</strong></td>
                        <td>Generated Product Preview</td>
                        <td>â€¢ Display product name, family, pricing model, SKUs, features<br>â€¢ Expandable/collapsible sections for each category<br>â€¢ Highlight confidence score for each field (High/Medium/Low)<br>â€¢ Show AI rationale tooltip (why this value was chosen)</td>
                    </tr>
                </table>
            </section>

            <section class="section-box">
                <h3><span class="badge-functional">Functional</span> Field-by-Field Review & Edit</h3>
                <table>
                    <tr><th>Requirement ID</th><th>Description</th><th>Acceptance Criteria</th></tr>
                    <tr>
                        <td><strong>FR-GEN-002.1</strong></td>
                        <td>Inline Editing</td>
                        <td>â€¢ Click any field to edit inline<br>â€¢ Type validation (text, number, picklist, date)<br>â€¢ Show field-level save button<br>â€¢ Undo/Redo support (up to 20 actions)</td>
                    </tr>
                    <tr>
                        <td><strong>FR-GEN-002.2</strong></td>
                        <td>Field Confidence Indicators</td>
                        <td>â€¢ âœ… Green badge = High confidence (â‰¥90%)<br>â€¢ âš ï¸ Yellow badge = Medium confidence (70-89%)<br>â€¢ âŒ Red badge = Low confidence (<70%)<br>â€¢ Tooltip shows AI reasoning and suggested alternatives</td>
                    </tr>
                    <tr>
                        <td><strong>FR-GEN-002.3</strong></td>
                        <td>SKU & Feature Management</td>
                        <td>â€¢ Add/Remove SKUs dynamically<br>â€¢ Drag-drop to reorder SKUs<br>â€¢ Clone SKU to create similar variant<br>â€¢ Bulk edit pricing (apply % discount to all SKUs)</td>
                    </tr>
                    <tr>
                        <td><strong>FR-GEN-002.4</strong></td>
                        <td>Validation Warnings</td>
                        <td>â€¢ Real-time validation (e.g., "Annual price should be <12x monthly")<br>â€¢ Show warnings in sidebar panel<br>â€¢ Click warning to jump to problematic field<br>â€¢ Option to ignore specific warnings</td>
                    </tr>
                </table>
            </section>

            <section class="section-box">
                <h3><span class="badge-functional">Functional</span> Save & Export</h3>
                <table>
                    <tr><th>Action</th><th>Behavior</th></tr>
                    <tr><td><strong>Save Draft</strong></td><td>Save to database with status = "Draft", auto-generate version number</td></tr>
                    <tr><td><strong>Save & Adopt</strong></td><td>Create product in Salesforce CPQ, set status = "Pending Approval"</td></tr>
                    <tr><td><strong>Export to Excel</strong></td><td>Download product spec as XLSX with SKU table, feature matrix, pricing sheet</td></tr>
                    <tr><td><strong>Export to PDF</strong></td><td>Generate formatted PDF report with AI rationale and confidence scores</td></tr>
                    <tr><td><strong>Start Over</strong></td><td>Clear form, confirm if unsaved changes exist</td></tr>
                </table>
            </section>

            <section class="section-box">
                <h3><span class="badge-technical">Technical</span> AI Engine - GPT-4 Prompt Engineering</h3>
                <pre style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:8px;overflow-x:auto">
// System Prompt Template
const SYSTEM_PROMPT = `
You are a Salesforce CPQ product configuration expert.
Extract structured product data from user descriptions.

Output JSON schema:
{
  "productName": string,
  "productFamily": string,
  "pricingModel": "one-time" | "subscription" | "usage-based",
  "billingFrequency": "monthly" | "annual" | "quarterly",
  "skus": [
    {
      "name": string,
      "price": number,
      "currency": string,
      "features": { "featureName": "featureValue" },
      "confidence": 0.0-1.0
    }
  ],
  "features": [
    { "name": string, "type": "boolean" | "numeric" | "picklist" }
  ]
}

Rules:
- Infer missing details from context (e.g., currency from user locale)
- Assign confidence scores based on explicitness in prompt
- Suggest industry-standard features if relevant
`;

// API Call
const response = await openai.chat.completions.create({
  model: "gpt-4-turbo-preview",
  messages: [
    { role: "system", content: SYSTEM_PROMPT },
    { role: "user", content: userInput }
  ],
  response_format: { type: "json_object" },
  temperature: 0.3, // Lower = more deterministic
  max_tokens: 2000
});
                </pre>
            </section>

            <section class="section-box">
                <h3><span class="badge-technical">Technical</span> Database Schema</h3>
                <pre style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:8px;overflow-x:auto">
CREATE TABLE ai_generated_products (
    product_id UUID PRIMARY KEY,
    user_id UUID NOT NULL,
    raw_prompt TEXT NOT NULL,
    attached_files JSONB, -- [{"filename": "...", "s3_url": "..."}]
    generated_config JSONB NOT NULL, -- Full AI output
    status VARCHAR(50) NOT NULL, -- 'draft', 'adopted', 'rejected'
    confidence_score NUMERIC(3,2), -- Average confidence 0.00-1.00
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_user_products ON ai_generated_products(user_id, created_at DESC);
                </pre>
            </section>

            <section class="section-box">
                <h3><span class="badge-technical">Technical</span> API Specification</h3>
                <table>
                    <tr><th>Endpoint</th><th>Method</th><th>Purpose</th></tr>
                    <tr><td>/api/v1/ai/generate</td><td>POST</td><td>Submit natural language prompt, return generated product JSON</td></tr>
                    <tr><td>/api/v1/ai/upload</td><td>POST</td><td>Upload reference files (PDF/DOCX), extract text, append to prompt</td></tr>
                    <tr><td>/api/v1/products/draft</td><td>POST</td><td>Save generated product as draft (not yet in Salesforce)</td></tr>
                    <tr><td>/api/v1/products/adopt</td><td>POST</td><td>Create product in Salesforce CPQ via Bulk API</td></tr>
                </table>
            </section>

            <section>
                <h2>Navigation</h2>
                <ul style="line-height:2">
                    <li><strong>Next:</strong> <a href="requirements-phase2-modify.html">Page 2: Modify with AI</a></li>
                    <li><strong>Back to:</strong> <a href="requirements-home.html">Requirements Home</a></li>
                </ul>
            </section>
        </main>
    </div>
    <script>
        // Collapsible navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Handle section headers - single click toggle
            const sectionHeaders = document.querySelectorAll('.nav-section-header');
            sectionHeaders.forEach(header => {
                const newHeader = header.cloneNode(true);
                header.parentNode.replaceChild(newHeader, header);
            });
            
            document.querySelectorAll('.nav-section-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const content = this.nextElementSibling;
                    const isExpanded = this.classList.contains('expanded');
                    
                    if (isExpanded) {
                        this.classList.remove('expanded');
                        content.classList.remove('expanded');
                    } else {
                        this.classList.add('expanded');
                        content.classList.add('expanded');
                    }
                });
            });
            
            // Handle subsection headers - single click toggle
            const subsectionHeaders = document.querySelectorAll('.nav-subsection-header');
            subsectionHeaders.forEach(header => {
                const newHeader = header.cloneNode(true);
                header.parentNode.replaceChild(newHeader, header);
            });
            
            document.querySelectorAll('.nav-subsection-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const content = this.nextElementSibling;
                    const isExpanded = this.classList.contains('expanded');
                    
                    if (isExpanded) {
                        this.classList.remove('expanded');
                        content.classList.remove('expanded');
                    } else {
                        this.classList.add('expanded');
                        content.classList.add('expanded');
                    }
                });
            });
            
            // Auto-expand section containing active link
            const activeLinks = document.querySelectorAll('.nav-link.active, .nav-subsection-link.active');
            activeLinks.forEach(link => {
                // Expand parent section
                let section = link.closest('.nav-section-content');
                if (section) {
                    section.classList.add('expanded');
                    section.previousElementSibling.classList.add('expanded');
                }
                
                // Expand parent subsection if exists
                let subsection = link.closest('.nav-subsection-content');
                if (subsection) {
                    subsection.classList.add('expanded');
                    subsection.previousElementSibling.classList.add('expanded');
                }
            });
        });
    </script>

    <script>
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', function() {
            // Clone all section headers to remove any duplicate event listeners
            const sectionHeaders = document.querySelectorAll('.nav-section-header');
            sectionHeaders.forEach(header => {
                const newHeader = header.cloneNode(true);
                header.parentNode.replaceChild(newHeader, header);
            });
            
            // Clone all subsection headers
            const subsectionHeaders = document.querySelectorAll('.nav-subsection-header');
            subsectionHeaders.forEach(header => {
                const newHeader = header.cloneNode(true);
                header.parentNode.replaceChild(newHeader, header);
            });
            
            // Add click handlers to main section headers
            document.querySelectorAll('.nav-section-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const content = this.nextElementSibling;
                    const isExpanded = this.classList.contains('expanded');
                    
                    if (isExpanded) {
                        this.classList.remove('expanded');
                        content.classList.remove('expanded');
                    } else {
                        this.classList.add('expanded');
                        content.classList.add('expanded');
                    }
                });
            });
            
            // Add click handlers to subsection headers
            document.querySelectorAll('.nav-subsection-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const content = this.nextElementSibling;
                    const isExpanded = this.classList.contains('expanded');
                    
                    if (isExpanded) {
                        this.classList.remove('expanded');
                        content.classList.remove('expanded');
                    } else {
                        this.classList.add('expanded');
                        content.classList.add('expanded');
                    }
                });
            });
            
            // Auto-expand section containing active link
            const activeLink = document.querySelector('.nav-link.active, .nav-subsection-link.active');
            if (activeLink) {
                let parent = activeLink.parentElement;
                while (parent && !parent.classList.contains('sidebar')) {
                    if (parent.classList.contains('nav-section-content') || parent.classList.contains('nav-subsection-content')) {
                        parent.classList.add('expanded');
                        const header = parent.previousElementSibling;
                        if (header) {
                            header.classList.add('expanded');
                        }
                    }
                    parent = parent.parentElement;
                }
            }
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Phase 2 - Adopt AI Suggestions | RevNova Requirements</title>
    <link rel="stylesheet" href="../styles.css">
    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; }
        .requirements-layout{display:flex;min-height:calc(100vh - 80px);margin-top:80px}
        .sidebar{width:280px;background:#f8f9fa;border-right:1px solid #e0e0e0;padding:2rem 0;position:fixed;left:0;top:80px;height:calc(100vh - 80px);overflow-y:auto;z-index:100}
        .sidebar h3{padding:0 1.5rem;font-size:0.85rem;color:#666;text-transform:uppercase;letter-spacing:0.5px;margin:1.5rem 0 0.5rem}
        .sidebar ul{list-style:none;padding:0;margin:0}
        .sidebar ul li a{display:block;padding:0.6rem 1.5rem;color:#333;text-decoration:none;font-size:0.95rem;transition:all 0.2s}
        .sidebar ul li a:hover{background:#e9ecef;color:#11998e}
        .sidebar ul li a.active{background:#11998e;color:#fff;font-weight:500}
        .sidebar ul ul li a{padding-left:2.5rem;font-size:0.9rem}
        .main-content{flex:1;margin-left:280px;padding:3rem;background:#fff;min-width:0}
        .page-header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:3rem;border-radius:12px;margin-bottom:3rem}
        .section-box{background:#fff;border:2px solid #e0e0e0;padding:2.5rem;margin:2rem 0;border-radius:12px}
        .section-box h3{color:#667eea;margin-top:0;border-bottom:2px solid #764ba2;padding-bottom:0.5rem}
        table{width:100%;border-collapse:collapse;margin:1.5rem 0}
        th,td{border:1px solid #ddd;padding:12px;text-align:left}
        th{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;font-weight:600;font-size:0.85rem}
        .badge-functional{background:#3498db;color:#fff;padding:0.3rem 0.6rem;border-radius:12px;font-size:0.75rem;font-weight:600}
        .badge-technical{background:#e74c3c;color:#fff;padding:0.3rem 0.6rem;border-radius:12px;font-size:0.75rem;font-weight:600}
        .ui-wireframe{background:#f9f9f9;border:2px dashed #ccc;padding:1.5rem;margin:1rem 0;border-radius:8px;font-family:monospace;font-size:0.85rem;line-height:1.6}
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <div class="nav-left">
                <a href="../index.html" class="logo"><div class="logo-box">RevNova</div></a>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../about-revnova.html">About RevNova</a></li>
                        <li><a href="../features.html">Features</a></li>
                        <li><a href="../pricing.html">Pricing</a></li>
                        <li><a href="requirements-home.html" class="active">RevNova Requirements</a></li>
                        <li><a href="../contact.html">Contact</a></li>
                    </ul>
                </nav>
            </div>
            <div class="header-right">
                <div class="country-selector"><span class="fi fi-us"></span></div>
                <a href="../login.html" class="btn btn-login">Login</a>
            </div>
        </div>
    </header>

    <div class="requirements-layout">
        <aside class="sidebar">
            <h3>Platform Vision</h3>
            <ul>
                <li><a href="requirements-home.html">RevNova Vision & Strategy</a></li>
                <li><a href="business-requirements.html">High Level Business Requirements</a></li>
                <li><a href="high-level-functional.html">High Level Functional Design</a></li>
            </ul>
            
            <h3>Phase 1 - SFDC CPQ → RCA Migration (MVP)</h3>
            <ul>
                <li><a href="#">Functional Requirements</a>
                    <ul>
                        <li><a href="requirements-phase1-connect.html">1. Connection Wizard</a></li>
                        <li><a href="requirements-phase1-analyze.html">2. Schema Analysis</a></li>
                        <li><a href="requirements-phase1-mapping.html">3. Field Mapping</a></li>
                        <li><a href="requirements-phase1-transform.html">4. Data Transformation</a></li>
                        <li><a href="requirements-phase1-validate.html">5. Validation</a></li>
                        <li><a href="requirements-phase1-execute.html">6. Migration Execution</a></li>
                        <li><a href="requirements-phase1-test.html">7. Post-Migration Testing</a></li>
                    </ul>
                </li>
                <li><a href="requirements-phase1-technical.html">Technical Requirements</a>
                    <ul>
                        <li><a href="requirements-phase1-technical.html#architecture">Migration Architecture</a></li>
                        <li><a href="requirements-phase1-technical.html#api">API Specifications</a></li>
                        <li><a href="requirements-phase1-technical.html#database">Database Schema</a></li>
                        <li><a href="requirements-phase1-technical.html#orchestration">Orchestration Engine</a></li>
                    </ul>
                </li>
                <li><a href="requirements-mapping.html">Complete Field Mapping (70+ Fields)</a></li>
            </ul>
            
            <h3>Phase 2 - AI Product Configuration</h3>
            <ul>
                <li><a href="#">Functional Requirements</a>
                    <ul>
                        <li><a href="requirements-phase2-generate.html">Generate with AI</a></li>
                        <li><a href="requirements-phase2-modify.html">Modify with AI</a></li>
                        <li><a href="requirements-phase2-adopt.html">Adopt AI Suggestions</a></li>
                        <li><a href="requirements-phase2-planning.html">Planning Generators</a></li>
                        <li><a href="requirements-phase2-impact.html">Impact Analyzer</a></li>
                        <li><a href="requirements-phase2-budget.html">Budget Calculator</a></li>
                    </ul>
                </li>
                <li><a href="requirements-phase2-technical.html">Technical Requirements</a>
                    <ul>
                        <li><a href="requirements-phase2-technical.html#ai-engine">AI Engine Architecture</a></li>
                        <li><a href="requirements-phase2-technical.html#impact">Impact Analyzer Engine</a></li>
                        <li><a href="requirements-phase2-technical.html#budget">Budget Calculator Engine</a></li>
                        <li><a href="requirements-phase2-technical.html#api">API Specifications</a></li>
                    </ul>
                </li>
            </ul>
            
            <h3>Phase 3 - Multi-CPQ Support</h3>
            <ul>
                <li><a href="requirements-phase3-functional.html">Functional Requirements</a>
                    <ul>
                        <li><a href="requirements-phase3-functional.html#oracle">Oracle CPQ Connector</a></li>
                        <li><a href="requirements-phase3-functional.html#apttus">Apttus/Conga Connector</a></li>
                        <li><a href="requirements-phase3-functional.html#sap">SAP CPQ Connector</a></li>
                        <li><a href="requirements-phase3-functional.html#custom">Custom CPQ Connector</a></li>
                    </ul>
                </li>
                <li><a href="requirements-phase3-technical.html">Technical Requirements</a>
                    <ul>
                        <li><a href="requirements-phase3-technical.html#framework">Universal Connector Framework</a></li>
                        <li><a href="requirements-phase3-technical.html#mapping">Cross-Platform Mapping Engine</a></li>
                        <li><a href="requirements-phase3-technical.html#api">API Specifications</a></li>
                    </ul>
                </li>
            </ul>
            
            <h3>Phase 4 - CRM + CPQ Integration</h3>
            <ul>
                <li><a href="requirements-phase4-functional.html">Functional Requirements</a>
                    <ul>
                        <li><a href="requirements-phase4-functional.html#dynamics">Dynamics CRM+CPQ</a></li>
                        <li><a href="requirements-phase4-functional.html#sugar">Sugar CRM+CPQ</a></li>
                        <li><a href="requirements-phase4-functional.html#hubspot">HubSpot CRM+CPQ</a></li>
                        <li><a href="requirements-phase4-functional.html#zoho">Zoho CRM+CPQ</a></li>
                    </ul>
                </li>
                <li><a href="requirements-phase4-technical.html">Technical Requirements</a>
                    <ul>
                        <li><a href="requirements-phase4-technical.html#crm-architecture">CRM Migration Architecture</a></li>
                        <li><a href="requirements-phase4-technical.html#hierarchy">Account Hierarchy Engine</a></li>
                        <li><a href="requirements-phase4-technical.html#api">API Specifications</a></li>
                    </ul>
                </li>
            </ul>
            
            <h3>Phase 5 - ERP Integration</h3>
            <ul>
                <li><a href="requirements-phase5-functional.html">Functional Requirements</a>
                    <ul>
                        <li><a href="requirements-phase5-functional.html#sap">SAP ERP Connector</a></li>
                        <li><a href="requirements-phase5-functional.html#oracle">Oracle ERP Connector</a></li>
                        <li><a href="requirements-phase5-functional.html#dynamics">Dynamics 365 ERP</a></li>
                        <li><a href="requirements-phase5-functional.html#netsuite">NetSuite Connector</a></li>
                    </ul>
                </li>
                <li><a href="requirements-phase5-technical.html">Technical Requirements</a>
                    <ul>
                        <li><a href="requirements-phase5-technical.html#erp-architecture">ERP Integration Architecture</a></li>
                        <li><a href="requirements-phase5-technical.html#sync">Real-Time Sync Engine</a></li>
                        <li><a href="requirements-phase5-technical.html#api">API Specifications</a></li>
                    </ul>
                </li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h1>✅ Adopt AI Suggestions - Selective Change Application</h1>
                <p>Review, approve, and apply AI-generated changes with field-level granularity</p>
            </div>

            <div class="ui-wireframe">
┌────────────────────────────────────────────────────────────────┐
│  Review & Adopt AI Suggestions                        [Help] [?]│
├────────────────────────────────────────────────────────────────┤
│  Product: Professional Services Package                        │
│  Modification Request: "Add monthly retainer option..."        │
│  AI Confidence: 92%  •  Status: Pending Review                 │
│                                                                 │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ Change Summary:                          [Select All] [ ]│  │
│  │ ☑ 1 Field Modified  ☑ 2 SKUs Added  ☐ 0 Deletions       │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ▼ MODIFY: Billing Frequency                     [☑] Approve   │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ Current:                │ Proposed:                       │  │
│  │ One-time                │ One-time OR Monthly             │  │
│  │                         │                                 │  │
│  │ Confidence: 95%  •  Impact: Low  •  Effort: 1 hour       │  │
│  │ 💬 AI Rationale: User explicitly requested monthly option│  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ▼ ADD: Monthly Retainer SKU                     [☑] Approve   │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ New SKU Details:                                          │  │
│  │ • Name: Professional Services - Monthly Retainer         │  │
│  │ • Price: $500/month                                       │  │
│  │ • Custom Field: Included_Hours__c = 10                   │  │
│  │ • Product Family: Professional Services                  │  │
│  │                                                           │  │
│  │ Confidence: 88%  •  Impact: Medium  •  Effort: 2 hours   │  │
│  │ ⚠️ Warning: Requires new custom field creation            │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ▼ ADD: Premium SLA Feature                      [☐] Reject    │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │ New Feature Details:                                      │  │
│  │ • Name: Premium Support SLA                              │  │
│  │ • Type: Add-on (optional)                                │  │
│  │ • Price: $200/month                                       │  │
│  │ • Response Time SLA: < 2 hours                           │  │
│  │                                                           │  │
│  │ Confidence: 82%  •  Impact: High  •  Effort: 8 hours     │  │
│  │ ⚠️ Warning: Integration with support ticketing required   │  │
│  │ 💬 Reviewer Note: "Not ready for this release - defer"   │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                 │
│  Adoption Summary: 2 of 3 changes approved                     │
│                                                                 │
│     [💾 Save for Later]   [📧 Send for Approval]   [✅ Apply Now]│
└────────────────────────────────────────────────────────────────┘
            </div>

            <section class="section-box">
                <h3><span class="badge-functional">Functional</span> Side-by-Side Comparison View</h3>
                <table>
                    <tr><th>Requirement ID</th><th>Description</th><th>Acceptance Criteria</th></tr>
                    <tr>
                        <td><strong>FR-ADOPT-001.1</strong></td>
                        <td>Change-by-Change Review</td>
                        <td>• Display each change as expandable card<br>• Show Current vs Proposed in split-pane view<br>• Highlight differences in yellow (modified fields)<br>• Show field-level metadata (data type, required, custom)</td>
                    </tr>
                    <tr>
                        <td><strong>FR-ADOPT-001.2</strong></td>
                        <td>Confidence & Impact Indicators</td>
                        <td>• Display AI confidence score (0-100%) with color coding (Green ≥90%, Yellow 70-89%, Red <70%)<br>• Show impact level: Low (cosmetic), Medium (adds fields), High (breaks integrations)<br>• Estimate implementation effort in hours<br>• List affected downstream systems (e.g., "Updates required in CRM, ERP")</td>
                    </tr>
                    <tr>
                        <td><strong>FR-ADOPT-001.3</strong></td>
                        <td>AI Rationale & Warnings</td>
                        <td>• Show AI's reasoning for each change in collapsible section<br>• Display warnings with severity icons (🔴 Critical, ⚠️ Warning, ℹ️ Info)<br>• Link to documentation for breaking changes<br>• Suggest mitigation steps (e.g., "Test on sandbox first")</td>
                    </tr>
                </table>
            </section>

            <section class="section-box">
                <h3><span class="badge-functional">Functional</span> Selective Approval Workflow</h3>
                <table>
                    <tr><th>Requirement ID</th><th>Description</th><th>Acceptance Criteria</th></tr>
                    <tr>
                        <td><strong>FR-ADOPT-002.1</strong></td>
                        <td>Checkbox Selection</td>
                        <td>• Individual checkbox next to each change (Approve/Reject)<br>• Select All / Deselect All buttons at top<br>• Auto-select high-confidence changes (≥90%) by default<br>• Disable checkbox if change has critical warnings (require explicit override)</td>
                    </tr>
                    <tr>
                        <td><strong>FR-ADOPT-002.2</strong></td>
                        <td>Reviewer Comments</td>
                        <td>• Add comments to each change (e.g., "Approved by Sales VP", "Defer to v2.0")<br>• @mention other users for review<br>• Attach supporting documents (screenshots, approval emails)<br>• Track comment history (who said what, when)</td>
                    </tr>
                    <tr>
                        <td><strong>FR-ADOPT-002.3</strong></td>
                        <td>Dependency Checking</td>
                        <td>• Detect dependencies between changes (e.g., "SKU B requires Field A to be added first")<br>• Show dependency graph visualization<br>• Prevent partial adoption if dependencies exist<br>• Suggest optimal adoption order</td>
                    </tr>
                    <tr>
                        <td><strong>FR-ADOPT-002.4</strong></td>
                        <td>Conflict Resolution</td>
                        <td>• Detect conflicts (e.g., two changes modify same field differently)<br>• Highlight conflicts in red border<br>• Provide conflict resolution UI (choose Change A, Change B, or manual merge)<br>• Re-run AI if manual merge needed</td>
                    </tr>
                </table>
            </section>

            <section class="section-box">
                <h3><span class="badge-functional">Functional</span> Application & Rollback</h3>
                <table>
                    <tr><th>Action</th><th>Behavior</th></tr>
                    <tr><td><strong>Save for Later</strong></td><td>Save approved changes to database (status = "saved"), no Salesforce changes yet</td></tr>
                    <tr><td><strong>Send for Approval</strong></td><td>Email stakeholders with summary, link to review page, request approval within 48 hours</td></tr>
                    <tr><td><strong>Apply Now (Sandbox)</strong></td><td>Apply to Salesforce sandbox, generate test report, notify QA team</td></tr>
                    <tr><td><strong>Apply Now (Production)</strong></td><td>Apply to production org, create change set backup, send success notification</td></tr>
                    <tr><td><strong>Rollback</strong></td><td>Revert to previous version (restore from backup), create rollback audit log entry</td></tr>
                </table>
            </section>

            <section class="section-box">
                <h3><span class="badge-technical">Technical</span> Merge & Conflict Detection Algorithm</h3>
                <pre style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:8px;overflow-x:auto">
// Detect conflicts when applying multiple changes
function detectConflicts(changes: Change[]): Conflict[] {
    const conflicts: Conflict[] = [];
    const fieldMap = new Map<string, Change[]>();
    
    // Group changes by field
    changes.forEach(change => {
        const key = change.field;
        if (!fieldMap.has(key)) fieldMap.set(key, []);
        fieldMap.get(key)!.push(change);
    });
    
    // Check for conflicts
    fieldMap.forEach((fieldChanges, fieldName) => {
        if (fieldChanges.length > 1) {
            // Multiple changes to same field
            const values = fieldChanges.map(c => c.proposedValue);
            const uniqueValues = new Set(values);
            
            if (uniqueValues.size > 1) {
                conflicts.push({
                    field: fieldName,
                    conflictingChanges: fieldChanges,
                    resolutionStrategy: 'MANUAL', // Require user to pick
                    severity: 'HIGH'
                });
            }
        }
    });
    
    return conflicts;
}

// Check dependencies
function checkDependencies(changes: Change[]): Dependency[] {
    const deps: Dependency[] = [];
    
    changes.forEach(change => {
        if (change.type === 'ADD' && change.requiredFields) {
            change.requiredFields.forEach(reqField => {
                const dependsOn = changes.find(c => c.field === reqField);
                if (!dependsOn) {
                    deps.push({
                        change: change.field,
                        dependsOn: reqField,
                        status: 'MISSING'
                    });
                }
            });
        }
    });
    
    return deps;
}
                </pre>
            </section>

            <section class="section-box">
                <h3><span class="badge-technical">Technical</span> Database Schema - Adoption Tracking</h3>
                <pre style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:8px;overflow-x:auto">
CREATE TABLE adoption_sessions (
    session_id UUID PRIMARY KEY,
    modification_id UUID NOT NULL,
    reviewer_id UUID NOT NULL,
    approved_changes JSONB NOT NULL, -- Array of change IDs that were approved
    rejected_changes JSONB NOT NULL, -- Array of change IDs that were rejected
    comments JSONB, -- { "change_id": "comment text" }
    applied_at TIMESTAMP,
    rollback_point JSONB, -- Backup of pre-change state for rollback
    status VARCHAR(50) NOT NULL -- 'draft', 'pending_approval', 'applied', 'rolled_back'
);

CREATE INDEX idx_adoption_reviewer ON adoption_sessions(reviewer_id, applied_at DESC);
                </pre>
            </section>

            <section>
                <h2>Navigation</h2>
                <ul style="line-height:2">
                    <li><strong>Previous:</strong> <a href="requirements-phase2-modify.html">Page 2: Modify with AI</a></li>
                    <li><strong>Next:</strong> <a href="requirements-phase2-planning.html">Page 4: Planning Tools</a></li>
                </ul>
            </section>
        </main>
    </div>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Phase 2 - Modify with AI | RevNova Requirements</title>
    <link rel="stylesheet" href="../styles.css">
        <style>
        .requirements-layout{display:flex;min-height:calc(100vh - 80px);margin-top:80px}
        .sidebar{width:280px;background:#f4f6f9;border-right:1px solid #c9c9c9;position:fixed;height:calc(100vh - 80px);overflow-y:auto;top:80px;left:0;z-index:100}
        .sidebar::-webkit-scrollbar{width:8px}
        .sidebar::-webkit-scrollbar-track{background:#f4f6f9}
        .sidebar::-webkit-scrollbar-thumb{background:#c9c9c9;border-radius:4px}
        .sidebar::-webkit-scrollbar-thumb:hover{background:#a8a8a8}
        .sidebar-nav{padding:1rem 0}
        .nav-section{margin-bottom:0.25rem}
        .nav-section-header{display:flex;align-items:center;padding:0.5rem 1rem;font-size:13px;font-weight:600;color:#181818;background:none;border:none;width:100%;text-align:left;cursor:pointer;transition:background 0.15s}
        .nav-section-header:hover{background:#e5e5e5}
        .nav-section-header.expanded{background:#e5e5e5}
        .nav-section-icon{width:16px;height:16px;margin-right:0.5rem;transition:transform 0.2s;flex-shrink:0}
        .nav-section-header.expanded .nav-section-icon{transform:rotate(90deg)}
        .nav-section-content{max-height:0;overflow:hidden;transition:max-height 0.3s ease-out}
        .nav-section-content.expanded{max-height:2000px}
        .nav-link{display:block;padding:0.5rem 1rem 0.5rem 2.5rem;color:#006dcc;text-decoration:none;font-size:13px;transition:background 0.15s}
        .nav-link:hover{background:#e5e5e5;text-decoration:underline}
        .nav-link.active{background:#1589ee;color:#fff;font-weight:600}
        .nav-link.active:hover{background:#0b5cab;text-decoration:none}
        .nav-subsection{margin:0.25rem 0}
        .nav-subsection-header{display:flex;align-items:center;padding:0.5rem 1rem 0.5rem 2.5rem;font-size:13px;font-weight:500;color:#181818;background:none;border:none;width:100%;text-align:left;cursor:pointer;transition:background 0.15s}
        .nav-subsection-header:hover{background:#e5e5e5}
        .nav-subsection-header.expanded{background:#e5e5e5}
        .nav-subsection-icon{width:12px;height:12px;margin-right:0.5rem;transition:transform 0.2s;flex-shrink:0}
        .nav-subsection-header.expanded .nav-subsection-icon{transform:rotate(90deg)}
        .nav-subsection-content{max-height:0;overflow:hidden;transition:max-height 0.3s ease-out}
        .nav-subsection-content.expanded{max-height:1000px}
        .nav-subsection-link{display:block;padding:0.4rem 1rem 0.4rem 3.5rem;color:#006dcc;text-decoration:none;font-size:13px;transition:background 0.15s}
        .nav-subsection-link:hover{background:#e5e5e5;text-decoration:underline}
        .nav-subsection-link.active{background:#1589ee;color:#fff;font-weight:600}
        .nav-subsection-link.active:hover{background:#0b5cab;text-decoration:none}
        .main-content{flex:1;margin-left:280px;padding:2rem 3rem;background:#fff}
        
        .page-header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:3rem;border-radius:12px;margin-bottom:3rem}
        .section-box{background:#fff;border:2px solid #e0e0e0;padding:2.5rem;margin:2rem 0;border-radius:12px}
        .section-box h3{color:#667eea;margin-top:0;border-bottom:2px solid #764ba2;padding-bottom:0.5rem}
        table{width:100%;border-collapse:collapse;margin:1.5rem 0}
        th,td{border:1px solid #ddd;padding:12px;text-align:left}
        th{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;font-weight:600;font-size:0.85rem}
        .badge-functional{background:#3498db;color:#fff;padding:0.3rem 0.6rem;border-radius:12px;font-size:0.75rem;font-weight:600}
        .badge-technical{background:#e74c3c;color:#fff;padding:0.3rem 0.6rem;border-radius:12px;font-size:0.75rem;font-weight:600}
        .ui-wireframe{background:#f9f9f9;border:2px dashed #ccc;padding:1.5rem;margin:1rem 0;border-radius:8px;font-family:monospace;font-size:0.85rem;line-height:1.6}
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <div class="nav-left">
                <a href="../index.html" class="logo"><div class="logo-box">RevNova</div></a>
                <nav class="main-nav">
                    <ul>
                        <li><a href="../about-revnova.html">About RevNova</a></li>
                        <li><a href="../features.html">Features</a></li>
                        <li><a href="../pricing.html">Pricing</a></li>
                        <li><a href="requirements-home.html" class="active">RevNova Requirements</a></li>
                        <li><a href="../contact.html">Contact</a></li>
                    </ul>
                </nav>
            </div>
            <div class="header-right">
                <div class="country-selector"><span class="fi fi-us"></span></div>
                <a href="../login.html" class="btn btn-login">Login</a>
            </div>
        </div>
    </header>

    <div class="requirements-layout">
                        <aside class="sidebar">
            <nav class="sidebar-nav">
                <!-- Platform Vision Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Platform Vision
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-home.html" class="nav-link">RevNova Vision & Strategy</a>
                        <a href="business-requirements.html" class="nav-link">High Level Business Requirements</a>
                        <a href="high-level-functional.html" class="nav-link">High Level Functional Design</a>
                    </div>
                </div>
                
                <!-- Phase 1 Section -->
                <div class="nav-section">
                    <button class="nav-section-header expanded">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 1 - SFDC CPQ â†’ RCA Migration (MVP)
                    </button>
                    <div class="nav-section-content expanded">
                        <!-- Functional Requirements Subsection -->
                        <div class="nav-subsection">
                            <button class="nav-subsection-header">
                                <svg class="nav-subsection-icon" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M6 6L14 10L6 14V6Z"/>
                                </svg>
                                Functional Requirements
                            </button>
                            <div class="nav-subsection-content">
                                <a href="requirements-phase1-connect.html" class="nav-subsection-link">1. Connection Wizard</a>
                                <a href="requirements-phase1-analyze.html" class="nav-subsection-link">2. Schema Analysis</a>
                                <a href="requirements-phase1-mapping.html" class="nav-subsection-link">3. Field Mapping</a>
                                <a href="requirements-phase1-transform.html" class="nav-subsection-link">4. Data Transformation</a>
                                <a href="requirements-phase1-validate.html" class="nav-subsection-link">5. Validation</a>
                                <a href="requirements-phase1-execute.html" class="nav-subsection-link">6. Migration Execution</a>
                                <a href="requirements-phase1-test.html" class="nav-subsection-link">7. Post-Migration Testing</a>
                                <a href="requirements-phase1-quotes.html" class="nav-subsection-link">8. Quotes</a>
                                <a href="requirements-phase1-contracts.html" class="nav-subsection-link">9. Contracts</a>
                                <a href="requirements-phase1-subscriptions.html" class="nav-subsection-link">10. Subscriptions</a>
                                <a href="requirements-phase1-inflight.html" class="nav-subsection-link">11. In-Flight Orders</a>
                            </div>
                        </div>
                        
                        <!-- Technical Requirements Subsection -->
                        <div class="nav-subsection">
                            <button class="nav-subsection-header">
                                <svg class="nav-subsection-icon" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M6 6L14 10L6 14V6Z"/>
                                </svg>
                                Technical Requirements
                            </button>
                            <div class="nav-subsection-content">
                                <a href="requirements-phase1-technical.html" class="nav-subsection-link">Migration Architecture</a>
                                <a href="requirements-phase1-technical.html#api" class="nav-subsection-link">API Specifications</a>
                                <a href="requirements-phase1-technical.html#database" class="nav-subsection-link">Database Schema</a>
                                <a href="requirements-phase1-technical.html#orchestration" class="nav-subsection-link">Orchestration Engine</a>
                            </div>
                        </div>
                        
                        <a href="requirements-mapping.html" class="nav-link">Complete Field Mapping</a>
                    </div>
                </div>
                
                <!-- Phase 2 Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 2 - AI-Powered Configuration
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-phase2-functional.html" class="nav-link">Functional Requirements</a>
                        <a href="requirements-phase2-technical.html" class="nav-link">Technical Requirements</a>
                        <a href="ai-product-configuration.html" class="nav-link">AI Product Configuration Engine</a>
                    </div>
                </div>
                
                <!-- Phase 3 Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 3 - Multi-CPQ Support
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-phase3-functional.html" class="nav-link">Functional Requirements</a>
                        <a href="requirements-phase3-technical.html" class="nav-link">Technical Requirements</a>
                    </div>
                </div>
                
                <!-- Phase 4 Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 4 - CRM Integration
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-phase4-functional.html" class="nav-link">Functional Requirements</a>
                        <a href="requirements-phase4-technical.html" class="nav-link">Technical Requirements</a>
                    </div>
                </div>
                
                <!-- Phase 5 Section -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Phase 5 - ERP Connector
                    </button>
                    <div class="nav-section-content">
                        <a href="requirements-phase5-functional.html" class="nav-link">Functional Requirements</a>
                        <a href="requirements-phase5-technical.html" class="nav-link">Technical Requirements</a>
                    </div>
                </div>
                
                <!-- Additional Resources -->
                <div class="nav-section">
                    <button class="nav-section-header">
                        <svg class="nav-section-icon" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M6 6L14 10L6 14V6Z"/>
                        </svg>
                        Additional Resources
                    </button>
                    <div class="nav-section-content">
                        <a href="security-compliance.html" class="nav-link">Security & Compliance</a>
                        <a href="performance-scalability.html" class="nav-link">Performance & Scalability</a>
                    </div>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <div class="page-header">
                <h1>âœï¸ Modify with AI - Intelligent Product Updates</h1>
                <p>Use natural language to request changes to existing product configurations</p>
            </div>

            <div class="ui-wireframe">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Modify Existing Product with AI                      [Help] [?]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ğŸ” Select Product to Modify:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”½ [Professional Services Package]                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  Current Configuration:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Product Family: Professional Services                      â”‚ â”‚
â”‚  â”‚ Base Price: $5,000                                         â”‚ â”‚
â”‚  â”‚ Billing: One-time                                          â”‚ â”‚
â”‚  â”‚ Features: Onboarding, Training, Custom Integration        â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“ What changes would you like to make?                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ "Add a monthly retainer option at $500/month for ongoing  â”‚ â”‚
â”‚  â”‚  support. Include 10 support hours per month. Also add    â”‚ â”‚
â”‚  â”‚  an optional premium SLA feature for $200/month."         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚                    [ğŸ¤– Generate Modifications]                 â”‚
â”‚                                                                 â”‚
â”‚  âœ… AI Suggested Changes:                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âœï¸ MODIFY: Billing Frequency                               â”‚ â”‚
â”‚  â”‚    Current: One-time                                       â”‚ â”‚
â”‚  â”‚    Proposed: One-time OR Monthly (new option)             â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚ â• ADD: Monthly Retainer SKU                                â”‚ â”‚
â”‚  â”‚    Name: Professional Services - Monthly Retainer         â”‚ â”‚
â”‚  â”‚    Price: $500/month                                       â”‚ â”‚
â”‚  â”‚    Included Hours: 10 hours/month                         â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚ â• ADD: Premium SLA Feature                                 â”‚ â”‚
â”‚  â”‚    Name: Premium Support SLA                              â”‚ â”‚
â”‚  â”‚    Price: $200/month (add-on)                             â”‚ â”‚
â”‚  â”‚    Response Time: < 2 hours                               â”‚ â”‚
â”‚  â”‚                                                            â”‚ â”‚
â”‚  â”‚ ğŸ’¡ AI Recommendation:                                      â”‚ â”‚
â”‚  â”‚    Consider adding "rollover hours" feature for unused    â”‚ â”‚
â”‚  â”‚    support time (up to 20 hours max carryover)            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚       [ğŸ‘€ Preview Changes]   [ğŸ’¾ Save Draft]   [âŒ Cancel]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>

            <section class="section-box">
                <h3><span class="badge-functional">Functional</span> Product Selection & Context Loading</h3>
                <table>
                    <tr><th>Requirement ID</th><th>Description</th><th>Acceptance Criteria</th></tr>
                    <tr>
                        <td><strong>FR-MOD-001.1</strong></td>
                        <td>Product Selector</td>
                        <td>â€¢ Searchable dropdown with 100+ products (fuzzy search by name, code, family)<br>â€¢ Display product thumbnail + current status (Active/Inactive)<br>â€¢ Load full product config on selection (products, SKUs, features, pricing rules)<br>â€¢ Show last modified date and user</td>
                    </tr>
                    <tr>
                        <td><strong>FR-MOD-001.2</strong></td>
                        <td>Current Configuration Display</td>
                        <td>â€¢ Expandable/collapsible card showing all product fields<br>â€¢ Highlight custom fields vs standard fields<br>â€¢ Show related records count (e.g., "12 Price Rules", "5 Product Options")<br>â€¢ Export current config as JSON or PDF</td>
                    </tr>
                    <tr>
                        <td><strong>FR-MOD-001.3</strong></td>
                        <td>Version History</td>
                        <td>â€¢ Show last 10 modifications in timeline view<br>â€¢ Display who made changes, when, and what changed<br>â€¢ Option to revert to previous version<br>â€¢ Compare any two versions side-by-side</td>
                    </tr>
                </table>
            </section>

            <section class="section-box">
                <h3><span class="badge-functional">Functional</span> AI-Powered Modification Suggestions</h3>
                <table>
                    <tr><th>Requirement ID</th><th>Description</th><th>Acceptance Criteria</th></tr>
                    <tr>
                        <td><strong>FR-MOD-002.1</strong></td>
                        <td>Change Request Input</td>
                        <td>â€¢ Multi-line text area for natural language requests<br>â€¢ Show character count (min 20 chars, max 2000 chars)<br>â€¢ Voice input option (speech-to-text using Web Speech API)<br>â€¢ Sample prompts button (show 5 example modification requests)</td>
                    </tr>
                    <tr>
                        <td><strong>FR-MOD-002.2</strong></td>
                        <td>Change Detection & Categorization</td>
                        <td>â€¢ AI categorizes changes as: MODIFY, ADD, DELETE, RENAME<br>â€¢ Display each change type with distinct icon (âœï¸ Modify, â• Add, âŒ Delete, ğŸ”„ Rename)<br>â€¢ Show before/after values for MODIFY changes<br>â€¢ Indicate data model impact (e.g., "This adds 2 new custom fields")</td>
                    </tr>
                    <tr>
                        <td><strong>FR-MOD-002.3</strong></td>
                        <td>AI Recommendations</td>
                        <td>â€¢ Suggest related changes user may have missed (e.g., "Add corresponding discount rule?")<br>â€¢ Warn about potential conflicts (e.g., "This may break existing quote templates")<br>â€¢ Recommend best practices (e.g., "Consider tiered pricing instead of flat rate")<br>â€¢ Show confidence score for each suggestion (High/Medium/Low)</td>
                    </tr>
                    <tr>
                        <td><strong>FR-MOD-002.4</strong></td>
                        <td>Impact Preview</td>
                        <td>â€¢ Show how many quotes, orders, contracts will be affected<br>â€¢ Highlight breaking changes (e.g., "Removing this feature will affect 15 active quotes")<br>â€¢ Estimate implementation effort (Low/Medium/High complexity)<br>â€¢ Display downstream system impacts (e.g., "Update CRM integration required")</td>
                    </tr>
                </table>
            </section>

            <section class="section-box">
                <h3><span class="badge-functional">Functional</span> Change Approval Workflow</h3>
                <table>
                    <tr><th>Action</th><th>Behavior</th></tr>
                    <tr><td><strong>Preview Changes</strong></td><td>Show side-by-side diff: Current vs Proposed (field-level highlighting)</td></tr>
                    <tr><td><strong>Selective Adoption</strong></td><td>Checkboxes next to each change - user can accept/reject individually</td></tr>
                    <tr><td><strong>Add Comments</strong></td><td>Attach notes to specific changes (e.g., "Approved by Sales VP on 2024-03-15")</td></tr>
                    <tr><td><strong>Save Draft</strong></td><td>Save changes without applying to Salesforce, send for stakeholder review</td></tr>
                    <tr><td><strong>Apply Changes</strong></td><td>Update product in Salesforce CPQ, create audit log entry, notify affected teams</td></tr>
                </table>
            </section>

            <section class="section-box">
                <h3><span class="badge-technical">Technical</span> AI Modification Engine - Contextual Prompting</h3>
                <pre style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:8px;overflow-x:auto">
// System Prompt with Current Product Context
const MODIFICATION_PROMPT = `
You are modifying an existing Salesforce CPQ product.

Current Product Configuration:
${JSON.stringify(currentProduct, null, 2)}

User's Change Request:
"${userInput}"

Your task:
1. Identify all fields that need to change (MODIFY, ADD, DELETE, RENAME)
2. Generate new SKUs/features if requested
3. Suggest related changes user may have missed
4. Warn about potential breaking changes

Output JSON:
{
  "changes": [
    {
      "type": "MODIFY" | "ADD" | "DELETE" | "RENAME",
      "field": "field_name",
      "currentValue": any,
      "proposedValue": any,
      "confidence": 0.0-1.0,
      "reason": "why this change is needed"
    }
  ],
  "recommendations": [
    { "text": "...", "priority": "high" | "medium" | "low" }
  ],
  "warnings": [
    { "text": "...", "severity": "critical" | "warning" | "info" }
  ]
}
`;

const response = await openai.chat.completions.create({
  model: "gpt-4-turbo-preview",
  messages: [
    { role: "system", content: MODIFICATION_PROMPT },
    { role: "user", content: userInput }
  ],
  response_format: { type: "json_object" },
  temperature: 0.2 // Low temp for precise modifications
});
                </pre>
            </section>

            <section class="section-box">
                <h3><span class="badge-technical">Technical</span> Database Schema - Change Tracking</h3>
                <pre style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:8px;overflow-x:auto">
CREATE TABLE product_modification_history (
    modification_id UUID PRIMARY KEY,
    product_id UUID NOT NULL,
    user_id UUID NOT NULL,
    change_request TEXT NOT NULL, -- Natural language input
    ai_suggestions JSONB NOT NULL, -- Full AI response
    applied_changes JSONB, -- Subset of suggestions that were applied
    status VARCHAR(50) NOT NULL, -- 'draft', 'approved', 'rejected', 'applied'
    created_at TIMESTAMP DEFAULT NOW(),
    applied_at TIMESTAMP
);

CREATE INDEX idx_product_history ON product_modification_history(product_id, created_at DESC);
                </pre>
            </section>

            <section>
                <h2>Navigation</h2>
                <ul style="line-height:2">
                    <li><strong>Previous:</strong> <a href="requirements-phase2-generate.html">Page 1: Generate with AI</a></li>
                    <li><strong>Next:</strong> <a href="requirements-phase2-adopt.html">Page 3: Adopt AI Suggestions</a></li>
                </ul>
            </section>
        </main>
    </div>
    <script>
        // Collapsible navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Handle section headers - single click toggle
            const sectionHeaders = document.querySelectorAll('.nav-section-header');
            sectionHeaders.forEach(header => {
                const newHeader = header.cloneNode(true);
                header.parentNode.replaceChild(newHeader, header);
            });
            
            document.querySelectorAll('.nav-section-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const content = this.nextElementSibling;
                    const isExpanded = this.classList.contains('expanded');
                    
                    if (isExpanded) {
                        this.classList.remove('expanded');
                        content.classList.remove('expanded');
                    } else {
                        this.classList.add('expanded');
                        content.classList.add('expanded');
                    }
                });
            });
            
            // Handle subsection headers - single click toggle
            const subsectionHeaders = document.querySelectorAll('.nav-subsection-header');
            subsectionHeaders.forEach(header => {
                const newHeader = header.cloneNode(true);
                header.parentNode.replaceChild(newHeader, header);
            });
            
            document.querySelectorAll('.nav-subsection-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const content = this.nextElementSibling;
                    const isExpanded = this.classList.contains('expanded');
                    
                    if (isExpanded) {
                        this.classList.remove('expanded');
                        content.classList.remove('expanded');
                    } else {
                        this.classList.add('expanded');
                        content.classList.add('expanded');
                    }
                });
            });
            
            // Auto-expand section containing active link
            const activeLinks = document.querySelectorAll('.nav-link.active, .nav-subsection-link.active');
            activeLinks.forEach(link => {
                // Expand parent section
                let section = link.closest('.nav-section-content');
                if (section) {
                    section.classList.add('expanded');
                    section.previousElementSibling.classList.add('expanded');
                }
                
                // Expand parent subsection if exists
                let subsection = link.closest('.nav-subsection-content');
                if (subsection) {
                    subsection.classList.add('expanded');
                    subsection.previousElementSibling.classList.add('expanded');
                }
            });
        });
    </script>

    <script>
        // Wait for DOM to be ready
        document.addEventListener('DOMContentLoaded', function() {
            // Clone all section headers to remove any duplicate event listeners
            const sectionHeaders = document.querySelectorAll('.nav-section-header');
            sectionHeaders.forEach(header => {
                const newHeader = header.cloneNode(true);
                header.parentNode.replaceChild(newHeader, header);
            });
            
            // Clone all subsection headers
            const subsectionHeaders = document.querySelectorAll('.nav-subsection-header');
            subsectionHeaders.forEach(header => {
                const newHeader = header.cloneNode(true);
                header.parentNode.replaceChild(newHeader, header);
            });
            
            // Add click handlers to main section headers
            document.querySelectorAll('.nav-section-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const content = this.nextElementSibling;
                    const isExpanded = this.classList.contains('expanded');
                    
                    if (isExpanded) {
                        this.classList.remove('expanded');
                        content.classList.remove('expanded');
                    } else {
                        this.classList.add('expanded');
                        content.classList.add('expanded');
                    }
                });
            });
            
            // Add click handlers to subsection headers
            document.querySelectorAll('.nav-subsection-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const content = this.nextElementSibling;
                    const isExpanded = this.classList.contains('expanded');
                    
                    if (isExpanded) {
                        this.classList.remove('expanded');
                        content.classList.remove('expanded');
                    } else {
                        this.classList.add('expanded');
                        content.classList.add('expanded');
                    }
                });
            });
            
            // Auto-expand section containing active link
            const activeLink = document.querySelector('.nav-link.active, .nav-subsection-link.active');
            if (activeLink) {
                let parent = activeLink.parentElement;
                while (parent && !parent.classList.contains('sidebar')) {
                    if (parent.classList.contains('nav-section-content') || parent.classList.contains('nav-subsection-content')) {
                        parent.classList.add('expanded');
                        const header = parent.previousElementSibling;
                        if (header) {
                            header.classList.add('expanded');
                        }
                    }
                    parent = parent.parentElement;
                }
            }
        });
    </script>
</body>
</html>

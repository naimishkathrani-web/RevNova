<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dev2 Day 19: Error Display - RevNova Onboarding</title>
    <link rel="stylesheet" href="../styles.css">
    <style>body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Ubuntu,sans-serif}.main-content{margin-left:280px;padding:2.5rem}.day-header{background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%);color:#fff;padding:1.5rem;border-radius:10px;margin-bottom:1rem}.step-card{background:#fff;border:1px solid #e0e0e0;padding:1rem;border-radius:8px;margin-bottom:1rem}.nav-buttons{display:flex;justify-content:space-between;margin-top:1.5rem}</style>
</head>
<body>
    <header>
        <div class="container header-container">
            <div class="nav-left">
                <a href="../index.html" class="logo"><div class="logo-box">RevNova</div></a>
                <nav class="main-nav">
                    <ul>
                        <li><a href="onboarding-home.html" class="active">Onboarding</a></li>
                        <li><a href="../about-revnova.html">About RevNova</a></li>
                        <li><a href="../features.html">Features</a></li>
                        <li><a href="../pricing.html">Pricing</a></li>
                        <li><a href="../RevNovaRequirements/requirements-home.html">RevNova Requirements</a></li>
                        <li><a href="../contact.html">Contact</a></li>
                    </ul>
                </nav>
            </div>
            <div class="header-right">
                <div class="country-selector"><span class="fi fi-us"></span></div>
                <a href="../login.html" class="btn btn-login">Login</a>
            </div>
        </div>
    </header>

    <div class="onboarding-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3>Getting Started</h3>
            <ul>
                <li><a href="onboarding-home.html">Onboarding Home</a></li>
                <li><a href="onboarding-overview.html">Project Overview</a></li>
                <li><a href="manual-repo-setup.html">Manual Repository Setup</a></li>
                <li><a href="repo-setup-guide.html">Automated Setup Guide</a></li>
            </ul>
            
            <h3>Developer Guides</h3>
            <ul>
                <li><a href="onboarding-dev1-phase1.html">Developer 1: Backend & Database</a></li>
                <li><a href="onboarding-dev2-phase1.html">Developer 2: Frontend & React</a></li>
                <li><a href="onboarding-dev3-phase1.html">Developer 3: DevOps & QA</a></li>
            </ul>
            
            <h3>Developer 2: Daily Tasks</h3>
            <ul>
                <li class="has-children"><span style="font-weight:600;color:#333;cursor:default;display:block;padding:0.6rem 0;">Week 1: React Setup</span>
                    <ul>
                        <li><a href="dev2-day01.html">Day 1: React Setup</a></li>
                        <li><a href="dev2-day02.html">Day 2: Component Library</a></li>
                        <li><a href="dev2-day03.html">Day 3: Wizard Layout & Routing</a></li>
                        <li><a href="dev2-day04.html">Day 4: State Management</a></li>
                        <li><a href="dev2-day05.html">Day 5: API Client & Week 1 PR</a></li>
                    </ul>
                </li>
                <li class="has-children"><span style="font-weight:600;color:#333;cursor:default;display:block;padding:0.6rem 0;">Week 2: Connection Wizard</span>
                    <ul>
                        <li><a href="dev2-day06.html">Day 6: Connection Form UI</a></li>
                        <li><a href="dev2-day07.html">Day 7: OAuth Integration</a></li>
                        <li><a href="dev2-day08.html">Day 8: Connection Testing</a></li>
                        <li><a href="dev2-day09.html">Day 9: Error Handling</a></li>
                        <li><a href="dev2-day10.html">Day 10: Week 2 Testing & PR</a></li>
                    </ul>
                </li>
                <li class="has-children"><span style="font-weight:600;color:#333;cursor:default;display:block;padding:0.6rem 0;">Week 3: Field Mapping UI</span>
                    <ul>
                        <li><a href="dev2-day11.html">Day 11: Mapping Table UI</a></li>
                        <li><a href="dev2-day12.html">Day 12: AI Suggestions Display</a></li>
                        <li><a href="dev2-day13.html">Day 13: Drag & Drop Mapping</a></li>
                        <li><a href="dev2-day14.html">Day 14: Bulk Operations</a></li>
                        <li><a href="dev2-day15.html">Day 15: Week 3 Testing & PR</a></li>
                    </ul>
                </li>
                <li class="has-children"><span style="font-weight:600;color:#333;cursor:default;display:block;padding:0.6rem 0;">Week 4: Transformation & Validation</span>
                    <ul>
                        <li><a href="dev2-day16.html">Day 16: Transformation Preview UI</a></li>
                        <li><a href="dev2-day17.html">Day 17: Data Tables & Pagination</a></li>
                        <li><a href="dev2-day18.html">Day 18: Validation Results Display</a></li>
                        <li><a href="dev2-day19.html">Day 19: Error Display</a></li>
                        <li><a href="dev2-day20.html">Day 20: Week 4 Testing & PR</a></li>
                    </ul>
                </li>
                <li class="has-children"><span style="font-weight:600;color:#333;cursor:default;display:block;padding:0.6rem 0;">Week 5: Execution & Reports</span>
                    <ul>
                        <li><a href="dev2-day21.html">Day 21: Execution Progress UI</a></li>
                        <li><a href="dev2-day22.html">Day 22: Real-time Updates</a></li>
                        <li><a href="dev2-day23.html">Day 23: Test Reports & Comparison</a></li>
                        <li><a href="dev2-day24.html">Day 24: Export & UI Testing</a></li>
                        <li><a href="dev2-day25.html">Day 25: Final Polish & Documentation</a></li>
                    </ul>
                </li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
        <div class="day-header"><h1>Day 19: Error Display</h1><p>Developer 2 ‚Äî Frontend</p></div>

        <div class="step-card" style="background:#fffbea;border-left:4px solid #f59e0b;">
            <h2>‚ö†Ô∏è IMPORTANT: Start of Day Checklist</h2>
            <p><strong>Before starting today's work, run these commands:</strong></p>
            <div style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:6px;font-family:monospace;margin:1rem 0;">
cd C:\Dev\RevNovaRepository<br>
git pull origin main
            </div>
            <p>This ensures you have the latest code from your teammates. Always pull before starting work!</p>
        </div>

        <div class="step-card" style="background:#e0f2fe;border-left:4px solid #0284c7;">
            <h2>ü§ñ Copy This Prompt for Your GitHub Copilot</h2>
            <p><strong>Paste into Copilot Chat:</strong></p>
            <div style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:6px;font-family:monospace;margin:1rem 0;font-size:0.85rem;max-height:400px;overflow-y:auto;">
Day 19 - RevNova Frontend Developer<br><br>
**PLATFORM:** Salesforce CPQ ‚Üí Revenue Cloud migration SaaS. 7-step wizard with AI field mapping.<br>
**TECH:** React 18, TypeScript, TailwindCSS, Vite<br>
**REQUIREMENTS:** docs/RevNovaRequirements/ui-wireframes.html, functional-requirements.html<br>
**MVP:** Week 4/5 (Nov 30). ‚úÖWeeks 1-3: Wizard, mapping UI. üîÑWeek 4: Validation display.<br><br>
**CONTEXT:** Day 18 built ValidationResults with severity grouping (critical/error/warning/info)<br>
**TODAY:** Add error detail modal for field-level issues and export functionality<br><br>
**TASKS:**<br>
1. Create ErrorDetailModal component with field name, error type, affected records, suggestion<br>
2. Add "View Details" button to each validation issue<br>
3. Display sample affected records (first 5 rows) in modal<br>
4. Add "Export Errors CSV" button to download all validation issues<br>
5. Format CSV: Field, Severity, Message, Suggestion, Timestamp<br><br>
**API:** GET /api/mappings/:id/issues/:field returns { field, records: [{id, value, error}] }<br><br>
**ACCEPTANCE:** Clicking "View Details" opens modal with affected records. CSV exports all issues with headers.<br><br>
Guide me through building error detail modal with CSV export.
            </div>
        </div>

        <div class="step-card">
            <h2>üìã Objective</h2>
            <p>Add error detail modal for field-level issues and export functionality.</p>
        </div>

        <div class="step-card">
            <h2>üîç Step 1: Create ErrorDetailModal Component</h2>
            <p>Create <code>frontend/src/components/ErrorDetailModal.tsx</code>:</p>
            <div style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:6px;font-family:monospace;margin:1rem 0;font-size:0.85rem;">
import { useState, useEffect } from 'react';<br><br>

interface ErrorDetail {<br>
&nbsp;&nbsp;field: string;<br>
&nbsp;&nbsp;records: { id: string; value: string; error: string }[];<br>
}<br><br>

export default function ErrorDetailModal({ field, onClose }: { field: string; onClose: () => void }) {<br>
&nbsp;&nbsp;const [details, setDetails] = useState&lt;ErrorDetail | null&gt;(null);<br><br>

&nbsp;&nbsp;useEffect(() => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;fetchDetails();<br>
&nbsp;&nbsp;}, [field]);<br><br>

&nbsp;&nbsp;const fetchDetails = async () => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;const mappingId = sessionStorage.getItem('mappingId');<br>
&nbsp;&nbsp;&nbsp;&nbsp;const response = await fetch(`/api/mappings/${mappingId}/issues/${field}`);<br>
&nbsp;&nbsp;&nbsp;&nbsp;const data = await response.json();<br>
&nbsp;&nbsp;&nbsp;&nbsp;setDetails(data);<br>
&nbsp;&nbsp;};<br><br>

&nbsp;&nbsp;return (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div className="bg-white rounded-lg p-6 max-w-2xl w-full max-h-96 overflow-y-auto"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;h2 className="text-2xl font-bold mb-4"&gt;Error Details: {details?.field}&lt;/h2&gt;<br><br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div className="mb-4"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div className="text-sm text-gray-600 mb-2"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Affected Records: {details?.records.length || 0}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br><br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;table className="w-full border-collapse"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;thead&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr className="bg-gray-100"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th className="border p-2 text-left"&gt;Record ID&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th className="border p-2 text-left"&gt;Value&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;th className="border p-2 text-left"&gt;Error&lt;/th&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/thead&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tbody&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{details?.records.slice(0, 5).map(record => (<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;tr key={record.id}&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td className="border p-2"&gt;{record.id}&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td className="border p-2"&gt;{record.value}&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;td className="border p-2 text-red-600"&gt;{record.error}&lt;/td&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;))}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/tbody&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/table&gt;<br><br>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;button onClick={onClose} className="mt-4 px-4 py-2 bg-blue-600 text-white rounded"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Close<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/button&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;);<br>
}
            </div>
        </div>

        <div class="step-card">
            <h2>üìä Step 2: Update ValidationResults with Modal</h2>
            <p>Add modal state and trigger to <code>ValidationResults.tsx</code>:</p>
            <div style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:6px;font-family:monospace;margin:1rem 0;font-size:0.85rem;">
const [selectedField, setSelectedField] = useState&lt;string | null&gt;(null);<br><br>

// In IssueSection component:<br>
&lt;button<br>
&nbsp;&nbsp;onClick={() => setSelectedField(issue.field)}<br>
&nbsp;&nbsp;className="text-blue-600 text-sm underline mt-2"<br>
&gt;<br>
&nbsp;&nbsp;View Details<br>
&lt;/button&gt;<br><br>

// At end of return statement:<br>
{selectedField && (<br>
&nbsp;&nbsp;&lt;ErrorDetailModal<br>
&nbsp;&nbsp;&nbsp;&nbsp;field={selectedField}<br>
&nbsp;&nbsp;&nbsp;&nbsp;onClose={() => setSelectedField(null)}<br>
&nbsp;&nbsp;/&gt;<br>
)}
            </div>
        </div>

        <div class="step-card">
            <h2>üì• Step 3: Add CSV Export Functionality</h2>
            <p>Add export button to <code>ValidationResults.tsx</code>:</p>
            <div style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:6px;font-family:monospace;margin:1rem 0;font-size:0.85rem;">
const exportCSV = () => {<br>
&nbsp;&nbsp;if (!results) return;<br><br>

&nbsp;&nbsp;const headers = 'Field,Severity,Message,Suggestion,Timestamp\n';<br>
&nbsp;&nbsp;const rows = results.issues.map(issue => {<br>
&nbsp;&nbsp;&nbsp;&nbsp;const timestamp = new Date().toISOString();<br>
&nbsp;&nbsp;&nbsp;&nbsp;return `"${issue.field}","${issue.severity}","${issue.message}","${issue.suggestion || ''}","${timestamp}"`;<br>
&nbsp;&nbsp;}).join('\n');<br><br>

&nbsp;&nbsp;const csv = headers + rows;<br>
&nbsp;&nbsp;const blob = new Blob([csv], { type: 'text/csv' });<br>
&nbsp;&nbsp;const url = URL.createObjectURL(blob);<br>
&nbsp;&nbsp;const a = document.createElement('a');<br>
&nbsp;&nbsp;a.href = url;<br>
&nbsp;&nbsp;a.download = `validation-errors-${new Date().toISOString().split('T')[0]}.csv`;<br>
&nbsp;&nbsp;a.click();<br>
};<br><br>

// Add button after summary cards:<br>
&lt;button<br>
&nbsp;&nbsp;onClick={exportCSV}<br>
&nbsp;&nbsp;className="px-4 py-2 bg-green-600 text-white rounded mb-6"<br>
&gt;<br>
&nbsp;&nbsp;üì• Export Errors CSV<br>
&lt;/button&gt;
            </div>
        </div>

        <div class="step-card">
            <h2>üß™ Step 4: Test Error Display</h2>
            <p>Test validation UI manually:</p>
            <div style="background:#2d2d2d;color:#f8f8f2;padding:1rem;border-radius:6px;font-family:monospace;margin:1rem 0;font-size:0.85rem;">
# Start dev server<br>
cd frontend<br>
npm run dev<br><br>

# Navigate to http://localhost:5173/validation<br>
# Verify:<br>
# - Summary cards show correct counts<br>
# - Click "View Details" opens modal with affected records<br>
# - Click "Export CSV" downloads file with proper headers<br>
# - "Start Migration" button disabled with critical errors
            </div>
        </div>

        <div class="step-card">
            <h2>‚úÖ End of Day 19 Checklist</h2>
            <ul>
                <li>‚úÖ ErrorDetailModal shows affected records with IDs, values, errors</li>
                <li>‚úÖ "View Details" button opens modal for each validation issue</li>
                <li>‚úÖ Modal displays first 5 affected records</li>
                <li>‚úÖ "Export CSV" button downloads all validation issues</li>
                <li>‚úÖ CSV format includes Field, Severity, Message, Suggestion, Timestamp</li>
                <li>‚úÖ Manual testing confirmed modal and export work correctly</li>
                <li>‚úÖ Committed: <code>feat(frontend): add error detail modal and CSV export</code></li>
            </ul>
        </div>

        <div class="nav-buttons"><a href="dev2-day18.html" class="nav-btn back">‚Üê Back to Day 18</a><a href="dev2-day20.html" class="nav-btn next">Next: Day 20 ‚Üí</a></div>
            </main>
    </div>
    <script src="../script.js"></script>
</body>
</html>
